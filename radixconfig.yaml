apiVersion: radix.equinor.com/v1
kind: RadixApplication
metadata:
  name: data-marketplace
spec:
  environments:
    - name: prod
    - name: test
      build:
        from: main
  components:
    - name: web
      publicPort: http
      ports:
        - name: http
          port: 3000
      environmentConfig:
        - environment: prod
          resources:
            requests:
              memory: 256Mi
              cpu: 1000m
            limits:
              memory: 256Mi
              cpu: 1000m
          variables:
            BASE_URL: https://web-data-marketplace-test.radix.equinor.com/
            AUTH_SCOPE: https://equinor-test.collibra.com/user_impersonation
            NEXT_PUBLIC_COLLIBRA_BASE_URL: https://equinor-test.collibra.com/rest/2.0
            NEXT_PUBLIC_COLLIBRA_FIRST_TIME_VISITOR: https://equinor-test.collibra.com
        - environment: test
          resources:
            requests:
              memory: 256Mi
              cpu: 500m
            limits:
              memory: 256Mi
              cpu: 1000m
          variables:
            BASE_URL: https://web-data-marketplace-test.radix.equinor.com
            AUTH_SCOPE: https://equinor-test.collibra.com/user_impersonation
            NEXT_PUBLIC_COLLIBRA_BASE_URL: https://equinor-test.collibra.com/rest/2.0
            NEXT_PUBLIC_COLLIBRA_FIRST_TIME_VISITOR: https://equinor-test.collibra.com
      variables:
        NEXT_PUBLIC_APP_INSIGHTS_CONNECTION_STRING: InstrumentationKey=e4d53b02-e08f-45e0-8632-7a066b44bc4f;IngestionEndpoint=https://northeurope-2.in.applicationinsights.azure.com/;LiveEndpoint=https://northeurope.livediagnostics.monitor.azure.com/
      secrets:
        - AUTH_CLIENT_ID
        - AUTH_CLIENT_SECRET
        - AUTH_TENANT_ID
        - NEXTAUTH_URL
        - NEXTAUTH_SECRET
  dnsAppAlias:
    environment: prod
    component: web

  dnsExternalAlias:
    - alias: datamarketplace.equinor.com
      environment: prod
      component: web
